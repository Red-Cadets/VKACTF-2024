# Важные советы

| Cобытие       | Название       | Категория | Сложность |
|:-------------:|:-------------: |:---------:|:---------:|
| VKAСTF 2024 | home Sweet Home | Pwn | Средняя |

## Описание

>Автор [old3gg]
>
>Представьте, что вы по каким-то совершенно необъяснимым обстоятельствам попадаете в знаменитый San Andreas! Чем займётесь в первую очередь?)
 

## Решение

Делаем checksec бинаря - всё красное, радуемся. Ковыряем бинарь, тестим функционал, находим 2 уязвимости:

1) format string в функции print_graffiti
2) переполнение на единицу в функции ввода чит-кода

Так как стэк исполняемый можем записать шеллкод, будем использовать стандартный шеллкод для получения /bin/sh.
Используем переполнение на единицу, чтобы перезаписать младший байт RBP. Нам нужно указать RBP на адрес в буфере, по которому будет лежать наш шеллкод. Итак сначла ликаем адрес стэка, оставляем место под наш шеллкод, вычисляем каким должен быть послдений байт, грузим сначала адрес шеллкода, сам шеллкод, в конце переполняем нашим байтом.

[Решение автора](../exploit/splo.py)

### Флаг
```
vka{2_nUmb3R_9s_A_nUmb3r_9_l4rg3_a_NuMbeR_6_w1tH_eXtr4_D1p_a_numB3r_7_tWo_numBerS_45s_on3_w1th_che3se_4nd_a_Larg3_Sod4}
```
